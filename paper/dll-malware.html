<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" href="../icons/wallpaper/aranha.png"/>
    <link rel="stylesheet" type="text/css" href="../css/paper.css">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DLL Malware: A Growing Threat on the Global Scenario</title>
  </head>
  <body>
    </header>
    <main>
      <div class="post">
<div class="header">
  <h1>DLL Hijacking: The Bad Self-Confidence</h1>
<p>Jun 13, 2024 | Author: Maiquel Paiva (<a href="https://twitter.com/untw0">@untw0</a>)</p><br></div>

<p><img src="../icons/dll/dll-injection.png"></p>

<h1>Introduction</h1>
<p>DLLs (Dynamic Link Libraries) are essential components in software development, especially in Windows environments, as they allow the sharing of code and data among multiple programs, promoting modularity and code reuse. They save disk space and memory and facilitate software maintenance and updates. However, this same flexibility can be exploited by malware creators, who use DLLs to execute malicious code without the user's knowledge, infiltrating systems, stealing data, and maintaining persistent access to compromised networks.</p>

<h1>How a DLL Works</h1>
<p>DLLs (Dynamic Link Libraries) are designed to allow multiple programs to share common functionalities, promoting software modularity and efficiency. They contain executable code, resources, and data that can be accessed by various programs simultaneously. When a program needs a specific function or resource residing in a DLL, it makes a call to this library, loading it into memory only once, even if multiple programs use it. This saves system resources and reduces redundancy.</p>

<h1>Structure and Functioning</h1>
<p>A DLL is similar to an executable (EXE) but cannot be run directly. Instead, it is loaded and used by other executables or DLLs. It has an export table, which lists all the functions and resources available to other programs, and an import table, which specifies which functions and resources from other DLLs or executables it utilizes.</p>
<p><img src="../icons/dll/dll.png"></p>
<p>The image above illustrates how a DLL (Dynamic Link Library) works:</p>
ㅤ
<p>- Programs: There are two programs depicted (Program 1 and Program 2) that require specific functionalities.</p>
ㅤ
<p>- DLL: The DLL itself contains executable code, resources, and data that are shared among multiple programs.</p>
ㅤ
<p>- Arrows: These arrows signify that both programs make calls to the DLL in order to utilize its functionalities.</p>
ㅤ
<p>- Export Table: This table lists all the functions and resources that are available for other programs to use.</p>
ㅤ
<p>- Import Table: This table specifies which functions and resources from other DLLs or executables the current DLL utilizes.</p>

<h1>Malware DLL Example</h1>
<h2>DLL Hijacking</h2>
<p>DLL Hijacking is an attack where an attacker replaces a legitimate DLL with a malicious version. This attack exploits the way programs search for and load the necessary DLLs. Typically, programs first look for DLLs in the current working directory before checking system directories. An attacker can place a malicious DLL with the same name as the legitimate DLL in the directory where the program is executed. When the program attempts to load the DLL, it loads the malicious version, allowing the attacker to execute malicious code in the context of the target program, potentially gaining control of the system.</p>

<h1>Who DLL Hijacking in Practice</h1>
<p><img src="../icons/dll/malicious-dll.png"></p>

<h2>Procura pela DLL</h2>
<p>- DLL Original: Ao ser executado, o aplicativo precisa de funcionalidades adicionais fornecidas por uma DLL.</p>
ㅤ
<p>- Procura DLL: O aplicativo tenta carregar essa DLL necessária. Normalmente, o aplicativo especifica apenas o nome da DLL (por exemplo, lib.dll) e não o caminho completo.</p>

<h2>DLL Maliciosa</h2>
<p>- DLL Maliciosa: Um atacante coloca uma DLL maliciosa em um diretório onde o Windows procura por DLLs antes de verificar o diretório correto onde a DLL legítima deveria estar. A ideia é que o Windows carregue a DLL maliciosa em vez da DLL legítima devido à ordem de busca de diretórios.</p>
ㅤ
<p>- Nome da DLL: A DLL maliciosa é nomeada da mesma forma que a DLL legítima que o aplicativo alvo está procurando. Por exemplo, se o aplicativo procura por lib.dll, o atacante nomeará sua DLL maliciosa também como lib.dll.</p>

<h2>Execução do Código Malicioso</h2>
<p>- Carregamento da DLL: Quando o aplicativo alvo tenta carregar library.dll, o Windows encontra primeiro a DLL maliciosa no diretório de busca antes de encontrar a DLL legítima no diretório correto.</p>
ㅤ
<p>- Execução do Código: O Windows carrega a DLL maliciosa no processo do aplicativo alvo. Isso permite que o código malicioso contido na DLL seja executado dentro do contexto do aplicativo legítimo.</p>

<h2>Ações Maliciosas</h2>
<p>- Captura de Dados: O código malicioso pode realizar várias ações nocivas, como captura de dados sensíveis, como senhas, informações de cartão de crédito, etc.</p>
ㅤ
<p>- Controle do Sistema: Pode também assumir o controle do sistema, executar comandos arbitrários, modificar arquivos importantes do sistema, entre outras ações prejudiciais.</p>

<h1>Video mostrando um DLL Hijacking</h1>
<p></p>

</main>
    <footer>
      <a href="../index.html">/index.html</a>
    </footer>
  </body>
</html>
